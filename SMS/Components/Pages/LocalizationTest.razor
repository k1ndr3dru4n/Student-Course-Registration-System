@page "/localization-test"
@using Microsoft.Extensions.Localization
@using System.Globalization
@using SMS.Resources
@inject IStringLocalizer<SharedResources> Localizer

<div style="padding: 20px; font-family: Arial, sans-serif;">
    <h1>@Localizer["SystemTitle"]</h1>
    
    <div style="background: #f5f5f5; padding: 15px; margin: 15px 0; border-radius: 5px;">
        <h3>å½“å‰æ–‡åŒ–ä¿¡æ¯</h3>
        <p><strong>å½“å‰UIæ–‡åŒ–:</strong> @CultureInfo.CurrentUICulture.Name</p>
        <p><strong>å½“å‰æ–‡åŒ–:</strong> @CultureInfo.CurrentCulture.Name</p>
        <p><strong>æ˜¾ç¤ºåç§°:</strong> @CultureInfo.CurrentUICulture.DisplayName</p>
    </div>

    <div style="background: @(IsWorkingCorrectly() ? "#d4edda" : "#f8d7da"); padding: 15px; margin: 15px 0; border-radius: 5px;">
        <h3>@Localizer["Language"] - æœ¬åœ°åŒ–æµ‹è¯•</h3>
        <ul>
            <li><strong>@Localizer["SystemTitle"]:</strong> "@Localizer["SystemTitle"]"</li>
            <li><strong>@Localizer["Language"]:</strong> "@Localizer["Language"]"</li>
            <li><strong>@Localizer["Student"]:</strong> "@Localizer["Student"]"</li>
            <li><strong>@Localizer["Teacher"]:</strong> "@Localizer["Teacher"]"</li>
            <li><strong>@Localizer["Course"]:</strong> "@Localizer["Course"]"</li>
        </ul>
        <p><strong>çŠ¶æ€:</strong> @GetStatusMessage()</p>
    </div>

    <div style="background: #e3f2fd; padding: 15px; margin: 15px 0; border-radius: 5px;">
        <h3>è¯­è¨€åˆ‡æ¢æµ‹è¯•</h3>
        <p>
            <a href="/localization-test?culture=zh-CN" 
               style="padding: 8px 16px; background: #28a745; color: white; text-decoration: none; border-radius: 4px; margin-right: 8px;">
               ğŸ‡¨ğŸ‡³ ä¸­æ–‡
            </a>
            <a href="/localization-test?culture=en-US" 
               style="padding: 8px 16px; background: #007bff; color: white; text-decoration: none; border-radius: 4px;">
               ğŸ‡ºğŸ‡¸ English
            </a>
        </p>
        <p style="font-size: 12px; color: #666;">
            ç‚¹å‡»é“¾æ¥ç›´æ¥æµ‹è¯•è¯­è¨€åˆ‡æ¢ã€‚è¿™ä¸ªé¡µé¢ä¸ä½¿ç”¨Interactiveæ¨¡å¼ï¼Œåº”è¯¥èƒ½æ­£ç¡®æ˜¾ç¤ºæœ¬åœ°åŒ–å†…å®¹ã€‚
        </p>
    </div>
</div>

@code {
    private bool IsWorkingCorrectly()
    {
        if (CultureInfo.CurrentUICulture.Name == "zh-CN")
        {
            return Localizer["SystemTitle"].Value.Contains("å­¦ç”Ÿ") || Localizer["SystemTitle"].Value.Contains("ç®¡ç†");
        }
        return !Localizer["SystemTitle"].ResourceNotFound;
    }

    private string GetStatusMessage()
    {
        var culture = CultureInfo.CurrentUICulture.Name;
        var systemTitle = Localizer["SystemTitle"].Value;
        
        if (culture == "zh-CN")
        {
            if (systemTitle.Contains("å­¦ç”Ÿ") || systemTitle.Contains("ç®¡ç†"))
            {
                return $"âœ… ä¸­æ–‡æœ¬åœ°åŒ–å·¥ä½œæ­£å¸¸ - æ˜¾ç¤º: {systemTitle}";
            }
            else
            {
                return $"âŒ ä¸­æ–‡æœ¬åœ°åŒ–å¤±è´¥ - æ˜¾ç¤º: {systemTitle}ï¼ŒæœŸæœ›åŒ…å«'å­¦ç”Ÿ'æˆ–'ç®¡ç†'";
            }
        }
        else if (culture == "en-US")
        {
            if (systemTitle.Contains("Student") && systemTitle.Contains("Management"))
            {
                return $"âœ… è‹±æ–‡æœ¬åœ°åŒ–å·¥ä½œæ­£å¸¸ - æ˜¾ç¤º: {systemTitle}";
            }
            else
            {
                return $"âŒ è‹±æ–‡æœ¬åœ°åŒ–å¯èƒ½æœ‰é—®é¢˜ - æ˜¾ç¤º: {systemTitle}";
            }
        }
        else
        {
            return $"âš ï¸ æœªçŸ¥æ–‡åŒ–: {culture}, æ˜¾ç¤º: {systemTitle}";
        }
    }
}
